<div class="fixed inset-0 bg-gray-900 bg-opacity-10 flex items-center justify-center z-50">
  <mat-card class="max-w-4xl w-full p-0 relative overflow-hidden">
    
    <mat-card-header class="p-4 border-b border-gray-200 flex justify-between items-center">
      <mat-card-title class="text-xl font-bold">
        {{ type === 'sql' ? 'SQL Solution Code' : 'Execution Result' }} â€“ {{ file }}
      </mat-card-title>
      
      <button mat-icon-button (click)="close.emit()" class="text-gray-500 hover:text-gray-700">
        <mat-icon>close</mat-icon>
      </button>
    </mat-card-header>

    <mat-card-content class="p-4 min-h-24 flex flex-col">

      @if (loading) {
        <div class="flex justify-center items-center py-8">
          <mat-spinner diameter="30"></mat-spinner>
        </div>
      } 
      
      @if (!loading) {
        
        @if (type === 'sql') {
<pre class="language-sql bg-gray-100 p-3 rounded text-sm overflow-x-auto text-left whitespace-pre">
<code class="language-sql whitespace-pre"
    [innerHTML]="highlightSql(sqlContent || '')">
</code>
</pre>
        }

        @if (type === 'result') {
          <div class="mat-elevation-z2">
            <table 
              mat-table 
              [dataSource]="resultDataSource" 
              class="min-w-full text-sm"
            >
              @for (colName of executionColumns; track colName) {
                <ng-container [matColumnDef]="colName">
                  <th mat-header-cell *matHeaderCellDef 
                      class="bg-gray-100 px-4 py-2 font-semibold text-left border-r border-gray-300">
                    {{ colName | titlecase }}
                  </th>
                  <td mat-cell *matCellDef="let row" 
                      class="px-4 py-2 border-r border-gray-300">
                    {{ row[colName] === null ? 'NULL' : row[colName] }}
                  </td>
                </ng-container>
              }

              @if (executionResult.length > 0) {
                <tr mat-header-row *matHeaderRowDef="displayedResultColumns" class="border-b border-gray-300"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedResultColumns;" class="hover:bg-gray-50 transition"></tr>
              } 
              
              <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" [attr.colspan]="executionColumns.length || 1" 
                    class="px-4 py-3 text-center text-gray-500">
                  No results found or execution failed.
                </td>
              </tr>

            </table>
          </div>
        }
      } </mat-card-content> <mat-card-actions class="p-4 border-t border-gray-200 flex justify-end">
      <button mat-flat-button color="primary" (click)="close.emit()">
        Close
      </button>
    </mat-card-actions>
  </mat-card>
</div>